<div class="container">
  <div class="header">
    <h1 class="mat-headline-4">{{ 'userProfile.title' | translate }}</h1>
    <p class="mat-body-1">
      {{ 'userProfile.profileSubtitle' | translate }}
    </p>
  </div>

  <div class="content">
    <mat-card class="form-card">
      <mat-card-content>
        <form class="form-container">
          <!-- Basic Information Section -->
          <section class="form-section">
            <h2 class="mat-title">{{ 'userProfile.basicInfoSection' | translate }}</h2>

            <div class="fields-row">
              <!-- First Name -->
              <mat-form-field appearance="outline">
                <mat-label>{{ 'userProfile.firstNameLabel' | translate }}</mat-label>
                <input
                  matInput
                  type="text"
                  [formField]="personalForm.firstName"
                  placeholder="{{ 'userProfile.firstNamePlaceholder' | translate }}"
                />
                <mat-error>
                  <lib-field-error [fieldError]="personalForm.firstName()" />
                </mat-error>
              </mat-form-field>

              <!-- Last Name -->
              <mat-form-field appearance="outline">
                <mat-label>{{ 'userProfile.lastNameLabel' | translate }}</mat-label>
                <input
                  matInput
                  type="text"
                  [formField]="personalForm.lastName"
                  placeholder="{{ 'userProfile.lastNamePlaceholder' | translate }}"
                />
                <mat-error>
                  <lib-field-error [fieldError]="personalForm.lastName()" />
                </mat-error>
              </mat-form-field>
            </div>

            <!-- Date of Birth with Custom Age Validation -->
            <mat-form-field appearance="outline" class="full-width">
              <mat-label>{{ 'userProfile.dobLabel' | translate }}</mat-label>
              <input
                matInput
                type="date"
                [formField]="personalForm.dateOfBirth"
                placeholder="{{ 'userProfile.dobPlaceholder' | translate }}"
              />
              <mat-error>
                <lib-field-error [fieldError]="personalForm.dateOfBirth()" />
              </mat-error>
            </mat-form-field>
          </section>

          <mat-divider></mat-divider>

          <!-- Password Section with Custom Validation -->
          <section class="form-section">
            <h2 class="mat-title">{{ 'userProfile.passwordSection' | translate }}</h2>

            <div class="fields-row">
              <!-- Password with Custom Strength Validation -->
              <mat-form-field appearance="outline">
                <mat-label>{{ 'userProfile.passwordLabel' | translate }}</mat-label>
                <input
                  matInput
                  type="password"
                  [formField]="personalForm.password"
                  placeholder="{{ 'userProfile.passwordPlaceholder' | translate }}"
                />
                <mat-error>
                  <lib-field-error [fieldError]="personalForm.password()" />
                </mat-error>
              </mat-form-field>

              <!-- Confirm Password with Cross-field Validation -->
              <mat-form-field appearance="outline">
                <mat-label>{{ 'userProfile.confirmPasswordLabel' | translate }}</mat-label>
                <input
                  matInput
                  type="password"
                  [formField]="personalForm.confirmPassword"
                  placeholder="{{ 'userProfile.confirmPasswordPlaceholder' | translate }}"
                />
                <mat-error>
                  <lib-field-error [fieldError]="personalForm.confirmPassword()" />
                </mat-error>
              </mat-form-field>
            </div>
          </section>

          <mat-divider></mat-divider>

          <!-- Conditional Fields Section -->
          <section class="form-section">
            <h2 class="mat-title">{{ 'userProfile.additionalInfoSection' | translate }}</h2>

            <!-- Emergency Contact (Conditional Field) -->
            <div class="emergency-contact">
              <mat-checkbox [formField]="personalForm.hasEmergencyContact">
                {{ 'userProfile.emergencyContactExist' | translate }}
              </mat-checkbox>

              <div class="fields-row emergency-fields">
                <mat-form-field appearance="outline">
                  <mat-label>{{ 'userProfile.emergecyContactLabel' | translate }}</mat-label>
                  <input
                    matInput
                    type="text"
                    [formField]="personalForm.emergencyContactName"
                    placeholder="{{ 'userProfile.emergecyContactPlaceholder' | translate }}"
                  />
                  <mat-error>
                    <lib-field-error [fieldError]="personalForm.emergencyContactName()" />
                  </mat-error>
                </mat-form-field>

                <mat-form-field appearance="outline">
                  <mat-label>{{ 'userProfile.emergencyContactPhoneLabel' | translate }}</mat-label>
                  <input
                    matInput
                    type="tel"
                    [formField]="personalForm.emergencyContactPhone"
                    placeholder="{{ 'userProfile.emergencyContactPhonePlaceholder' | translate }}"
                  />
                  <mat-error>
                    <lib-field-error [fieldError]="personalForm.emergencyContactPhone()" />
                  </mat-error>
                </mat-form-field>
              </div>
            </div>
          </section>

          <!-- Submit Button -->
          <div class="submit-section">
            <button
              mat-raised-button
              color="primary"
              type="submit"
              class="submit-button"
            >
              {{ 'userProfile.submitProfil' | translate }}
            </button>
          </div>
        </form>
      </mat-card-content>
    </mat-card>

    <mat-card class="debug-card">
      <mat-card-header>
        <mat-card-title>Form Data</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <pre class="debug-pre">{{ personalForm().value() | json }}</pre>
        <pre class="debug-pre">{{ personalForm().errorSummary() | json }}</pre>
      </mat-card-content>
    </mat-card>
  </div>
</div>
